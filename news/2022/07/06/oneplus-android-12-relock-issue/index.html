<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OnePlus Android 12 firmware - relocking no longer works</title>
  
  <meta name="description" content="OnePlus Android 12 firmware - relocking no longer works" />
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="alternate" type="application/rss+xml" title="CalyxOS" href="/feed.xml">
  <script src="/assets/js/main.js" defer></script>
  
  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/images/favicon/site.webmanifest">
<link rel="shortcut icon" href="/assets/images/favicon/favicon.ico">
<meta name="apple-mobile-web-app-title" content="CalyxOS">
<meta name="application-name" content="CalyxOS">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/images/favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

</head>

  <body>
    <header>
  <div class="wrapper">
    <div class="logoMark emptyLogo"></div>
    <h1 class="logo"><a class="navbar-brand" href="/">CalyxOS</a></h1>
    <label class="clickable toggle search-toggle" for="search-checkbox" tabindex="0" role="button" aria-label="search"><i class="icon search"></i></label>
    <div class="search">
      <input type="checkbox" class="toggle modal-state" id="search-checkbox"></input>
      <div id="search" class="modal" style="">
        <label class="clickable toggle search-toggle" for="search-checkbox" title="close" tabindex="0" role="button"><i class="big icon close"></i></label>
        <form action="/search" id="searchform" name="searchform">
          <input type="search" name="q" autofocus="autofocus" placeholder="">
          <button type="submit">
            <i class="icon headerSearch"></i> Search
          </button>
        </form>
      </div>
    </div>
    <nav class="navbar">
      <input type="checkbox" class="toggle" id="navbar-visible"></input>
      <ul class="navbar-nav">
        <li class="nav-level-0 nav-item"><a class="nav-level-0 nav-link " href="/features/">Features</a></li>
<li class="nav-level-0 nav-item"><a class="nav-level-0 nav-link " href="/community/">Community</a></li>
<li class="nav-level-0 nav-item"><a class="nav-level-0 nav-link " href="/docs/">Documentation</a></li>
<li class="nav-level-0 nav-item"><a class="nav-level-0 nav-link active" href="/news/">News</a></li>
        <li><a role="button" class="btn primaryBtn" href="/install">Get CalyxOS</a></li>
      </ul>
      <label class="clickable toggle navbar-toggle" for="navbar-visible" role="button" aria-label="navigation"></label>
    </nav>
  </div>
</header>

    <main>
      <section class="secondaryIntro">
        <div class="wrapper">
          <h1><span class="highlighter">OnePlus Android 12 firmware - relocking no longer works</span></h1>
          
        </div>
      </section>
      <section class="content primaryContent wrapper">
        
        <p>CalyxOS test builds for the OnePlus 8T, 9 and 9 Pro have been shipping with the Android 11 firmware, since at the time the work to update custom ROMs to be based on that was still work in progress for some models, and for others full kernel source code was not available until recently.</p>

<p>However, now that full kernel source code is available, and a big chunk of the work needed is done, we started integrating those changes into the CalyxOS codebase and made some test builds.</p>

<p>Unfortunately, re-locking the bootloader with a custom ROM installed no longer works with the latest Android 12 firmware from OnePlus. :(</p>

<h3 id="what-you-need-to-do">What you need to do</h3>

<ul>
  <li>
    <p>We will be looking at everything and make another post with findings with next steps.</p>
  </li>
  <li>
    <p>For now, we’ll make updates with Android 11 firmware since we’ve already released test builds and would like to provide updates with at least the open source parts of the latest security patch and other general CalyxOS improvements.</p>
  </li>
  <li>
    <p>We have pulled the links to the existing builds till then while we figure this out.</p>
  </li>
</ul>

<h3 id="technical-details">Technical details</h3>

<p>With the Android 12 update, OnePlus <a href="https://www.androidpolice.com/2021/09/20/oneplus-details-how-its-going-to-merge-oxygenos-and-oppos-coloros/">changed codebases</a> to be more closely based on <a href="https://www.androidpolice.com/oxygenos-12-beta-handson-color-os-in-all-but-name/">Oppo software</a>, and the unification is <a href="https://www.androidpolice.com/oneplus-calls-off-merger-between-oxygenos-and-coloros-but-theyll-still-share-a-codebase/">going to continue</a>.</p>

<p>This meant a lot of changes for custom ROMs all around - to the proprietary files, the kernel code, hardware code (such as fingerprint reader), and also the bootloader.</p>

<p>Sadly, based on our testing, it appears that re-locking the bootloader after installing a custom ROM (aka <a href="https://android.googlesource.com/platform/external/avb/#device-specific-notes">AVB Yellow state</a>) is no longer working with OnePlus’ Android 12 bootloader (and associated proprietary components).</p>

<p>It is possible that we might be missing some change to make it work with OnePlus’ Android 12 bootloader, but we’ve tried a bunch of things without any luck.</p>

<p>We also tried reverting some components (mainly just the bootloader) to Android 11 while keeping the rest of the proprietary bits matching OnePlus Android 12, but that didn’t help either.</p>

<p>Relocking worked fine with the Android 11 bootloader (and associated proprietary components).</p>

<h3 id="our-options">Our options</h3>

<p>This means that we will not be able to merge the Android 12 changes into our codebase for now, given that an update with that included would lead to a non-functional device for anyone with a locked bootloader, which would have to be recovered with <a href="https://www.xda-developers.com/oneplus-9-9-pro-9r-unbrick-msmdownloadtool/">MsmDownloadTool</a></p>

<p>All of the possible ways have been listed below, while we evaulate them to decide on the future.</p>

<h4 id="best-case-scenario">Best case scenario</h4>
<ul>
  <li>OnePlus re-adds this functionality, given that they’ve supported this on pretty much all of their <a href="https://hub.libranet.de/wiki/and-priv-sec/wiki/verified-boot#OnePlus">previous devices</a></li>
  <li>This would mean we can simply make an update with the fix included and it would be entirely seamless.</li>
</ul>

<h4 id="future-android-13">Future (Android 13)</h4>
<ul>
  <li>We’ll keep trying all options, and keep posting updates here</li>
  <li>With all options there are some pretty significant cons making it hard to pick either</li>
</ul>

<h5 id="1-continue-with-android-11-bootloader-and-other-proprietary-components">1. Continue with Android 11 bootloader and other proprietary components</h5>
<p>Pros:</p>
<ul>
  <li>Locked bootloader</li>
</ul>

<p>Cons:</p>
<ul>
  <li>No security patches to any proprietary components.</li>
  <li>Diverging from other custom ROMs</li>
  <li>Becomes harder and harder to get newer Android versions running</li>
</ul>

<h5 id="2-update-to-android-12-bootloader-and-other-proprietary-components">2. Update to Android 12 bootloader and other proprietary components</h5>
<p>Pros:</p>
<ul>
  <li>Security updates</li>
  <li>Same as other custom ROMs</li>
</ul>

<p>Cons:</p>
<ul>
  <li>Unlocked bootloader, all the benefits of Verified Boot are lost</li>
</ul>

<h5 id="3-get-a-combination-of-android-11--12-components-working">3. Get a combination of Android 11 + 12 components working</h5>
<p>Pros:</p>
<ul>
  <li>Locked bootloader (if it works)</li>
  <li>Partial proprietary security updates (the components that are on 12)</li>
</ul>

<p>Cons:</p>
<ul>
  <li>Fragile</li>
  <li>Would still miss some security updates (the components that are on 11)</li>
</ul>

<!-- https://web.archive.org/web/20220705174359/https://hub.libranet.de/wiki/and-priv-sec/wiki/verified-boot -->


      </section>
    </main>
    <footer>
      
<div class="shade">
  <div class="wrapper">
    <div class="row">
      <ul>
        <li><a href="https://calyxinstitute.org/about">About Calyx</a></li>
        <li><a href="https://calyxinstitute.org/membership">Join Calyx</a></li>
        <li><a href="https://calyxinstitute.org/about/contact-us">Contact Us</a></li>
        <li><a href="https://calyxinstitute.org/legal/privacy-policy">Privacy Policy</a></li>
        <li><a href="https://calyxinstitute.org/legal/terms-of-service">Terms of Service</a></li>
        <li><a href="https://members.calyxinstitute.org/donate">Donate</a></li>
      </ul>
    </div>
    <div class="row footer-icons">
      <a href="https://app.element.io/#/room/#calyxos:matrix.org" title="CalyxOS chat room">
        <img class="filter-grey" src="/assets/images/icons/matrix.svg" />
      </a>
      <a href="https://gitlab.com/CalyxOS" title="CalyxOS source code">
        <img class="filter-grey" src="/assets/images/icons/git.svg" />
      </a>
      <a href="https://twitter.com/calyxinstitute" title="Calyx Institute on Twitter">
        <img class="filter-grey" src="/assets/images/icons/twitter.svg" />
      </a>
      <a rel="me" href="https://mastodon.social/@calyxinstitute" title="Calyx Institute on Mastodon">
        <img class="filter-grey" src="/assets/images/icons/mastodon.svg" />
      </a>
      <a href="https://reddit.com/r/CalyxOS" title="CalyxOS on Reddit">
        <img class="filter-grey" src="/assets/images/icons/reddit.svg" />
      </a>
      <a href="https://facebook.com/calyxinstitute" title="Calyx Institute on Facebook">
        <img class="filter-grey" src="/assets/images/icons/facebook.svg" />
      </a>
      <a href="https://instagram.com/calyxinsta" title="Calyx Institute on Instagram">
        <img class="filter-grey" src="/assets/images/icons/instagram.svg" />
      </a>
    </div>
    <div class="row">
      <a href="https://calyxinstitute.org" target="_blank" rel="noreferrer nooopener">&copy; 2021-2025 Calyx Institute</a>
      <span class="spacer" aria-hidden="true">&bull;</span>
      <a target="_blank" href="https://review.calyxos.org/admin/repos/edit/repo/CalyxOS/calyxos.org/branch/refs/heads/main/file/pages/_posts/2022-07-06-oneplus-android-12-relock-issue.md">Edit page</a>
    </div>
    <div class="row">
      <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer nofollow" title="License: Attribution-ShareAlike 4.0 International"><img class="filter-grey" style="height: 24px" src="/assets/images/icons/cc-by-sa.svg" /></a>
    </div>
  </div>
</div>

    </footer>
  </body>
</html>
